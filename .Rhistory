df1 <- aggregate(death_airPolution["Air.pollution..total...deaths.per.100.000."], by=death_airPolution["Year"], sum)
co2_emission <- read.csv("data/CO2_emission.csv")
death_airPolution <- read.csv("data/death-rates-from-air-pollution.csv")
popu_world <- read.csv("data/world_population.csv")
library(tidyverse)
library(highcharter)
library(forecast)
library(dplyr)
library(rmarkdown)
library(cowplot)
co2_emission <- read.csv("data/CO2_emission.csv")
death_airPolution <- read.csv("data/death-rates-from-air-pollution.csv")
popu_world <- read.csv("data/world_population.csv")
co2_emission <- read.csv("data/CO2_emission.csv")
death_airPolution <- read.csv("data/death-rates-from-air-pollution.csv")
co2_emission <- read.csv("data/CO2_emission.csv")
death_airPolution <- read.csv("data/death-rates-from-air-pollution.csv")
# to create a pageable table
paged_table(co2_emission, options = list(rows.print = 7, cols.print = 5))
paged_table(death_airPolution, options = list(rows.print = 7, cols.print = 5))
df1 <- aggregate(death_airPolution["Air.pollution..total...deaths.per.100.000."], by=death_airPolution["Year"], sum)
data_without_na <- replace(co2_emission, is.na(co2_emission), 0)
df2 <- data_without_na |>
select(starts_with("X"))
totEmission <- colSums(df2)
trial_df2 <- as.data.frame(totEmission)
data_new2 <- slice(trial_df2, 1:(n() - 2))                    # to drop 2018 and 2019 rows.
data_new3 <- rownames_to_column(data_new2, var = "Year")
data_new3$Year<-gsub("X","",as.character(data_new3$Year))     # to get rid of "X" in the beginning of Year column.
total <- merge(data_new3, df1, by="Year")                     # Finally, this will merge two data sets.
colnames(total)[3] <- "totAirPollt"
hc <- highchart() |>
hc_yAxis_multiples(
list(
title=list(text="CO2 emissions (metric ton per capita)"), lineWidth = 3, opposite = FALSE),
list(
title=list(text="Total death due to air pollution"), lineWidth = 3, opposite = TRUE)
) |>
hc_xAxis(
categories = total$Year, labels = list(rotation = -60, style = list(fontSize = "1.4vh")),
plotBands = list(list(color = "#ffcccb", from = 3, to = 5, label = list(text = "")))
) |>
hc_add_series(
data = total$totEmission, yAxis = 0, name = "Total CO<sub>2</sub> emission", color = '#fbb339'
) |>
hc_add_series(
data = total$totAirPollt,  color = "#2e6844", yAxis = 1, name = "Total death due to air Pollution"
) |>
hc_title(text = "Dual y-axis chart")
hc
df = subset(co2_emission, select = -c(country_code, Indicator.Name))
na.omit(df) |>
pivot_longer(cols = -c('Country', 'Region'), names_to = "Year", values_to = 'co2_Capita') -> dflonger
dflonger$Year<-gsub("X","", as.character(dflonger$Year))
data_new <- dflonger |>
filter(
Country %in% c("France", "Germany", "Luxembourg", "Belgium"),
Year >= 2000  , Year <= 2019
) |>
select(Year, Country, co2_Capita)
ggplot(data_new, aes(x = co2_Capita, y = Year, fill = Country)) +
geom_bar(stat = "identity", width = 0.7) +
labs(
title = "Share of global CO2 emission by 4 countries",
x = "CO2 emission (metric tons per capita)"
) +
scale_fill_brewer(palette = "Set3")
df1 <- aggregate(death_airPolution["Air.pollution..total...deaths.per.100.000."], by=death_airPolution["Year"], sum)
data_without_na <- replace(co2_emission, is.na(co2_emission), 0)
df2 <- data_without_na |>
select(starts_with("X"))
totEmission <- colSums(df2)
trial_df2 <- as.data.frame(totEmission)
data_new2 <- slice(trial_df2, 1:(n() - 2))                    # to drop 2018 and 2019 rows.
data_new3 <- rownames_to_column(data_new2, var = "Year")
data_new3$Year<-gsub("X","",as.character(data_new3$Year))     # to get rid of "X" in the beginning of Year column.
total <- merge(data_new3, df1, by="Year")                     # Finally, this will merge two data sets.
colnames(total)[3] <- "totAirPollt"
hc <- highchart() |>
hc_yAxis_multiples(
list(
title=list(text="CO2 emissions (metric ton per capita)"), lineWidth = 3, opposite = FALSE),
list(
title=list(text="Total death due to air pollution"), lineWidth = 3, opposite = TRUE)
) |>
hc_xAxis(
categories = total$Year, labels = list(rotation = -60, style = list(fontSize = "1.4vh")),
plotBands = list(list(color = "#ffcccb", from = 3, to = 5, label = list(text = "")))
) |>
hc_add_series(
data = total$totEmission, yAxis = 0, name = "Total CO<sub>2</sub> emission", color = '#fbb339'
) |>
hc_add_series(
data = total$totAirPollt,  color = "#2e6844", yAxis = 1, name = "Total death due to air Pollution"
) |>
hc_title(text = "Dual y-axis chart")
hc
death_airPolution |>
group_by(Year) |>
summarise(total = sum(Air.pollution..total...deaths.per.100.000.)) -> tot1
GData <- ts(tot1[,2], start = 1990, end = 2017, frequency = 1)
modeel<- tslm (GData~trend)
fcast <- forecast (modeel, h=5, level = c(8,95))
plot (
fcast, xlab ="Year", ylab ="Total death due to air pollution", main ="Time series linear model",
col.main ="black", col = 'red' , lwd=3.5
)
lines (fitted (modeel), col = 'blue', lwd=1.5)
legend(
'topright',inset=0.05,c("Data","Linear Fit"),lty=1,col=c("red","blue"), lwd=c(3.5,1.5)
)
text(1995, 18500, labels = "Slope: -372.4", pos = 4, cex = 1.1, col = "dodgerblue4")
violplot <- co2_emission |>
na.omit()
v1 <- ggplot(violplot, aes(x=reorder(Region,X1990, median),
y=X1990, fill=Region)) +
geom_violin(alpha=1.5, fill = "#30A9DC", colour = "#2429B3")+
stat_summary(fun = "median",
geom = "crossbar",
width = 0.5,
colour = "red"
) +
geom_point(position = position_jitterdodge(dodge.width = 0.9), alpha = 0.5) +
coord_flip()+
theme(legend.position = "none", text=element_text(size=15))+
ggtitle("Year = 1990") +
labs(x= "", y="Metric tone per capita")+
scale_y_continuous(trans = "sqrt")
v2 <- ggplot(violplot, aes(x=reorder(Region,X2000, median),
y=X2000, fill=Region)) +
geom_violin(alpha=1.5, fill = "#30A9DC", colour = "#2429B3")+
stat_summary(fun = "median",
geom = "crossbar",
width = 0.5,
colour = "red"
) +
geom_point(position = position_jitterdodge(dodge.width = 0.9), alpha = 0.5) +
coord_flip() +
theme(legend.position = "none", text=element_text(size=15)) +
ggtitle("Year = 2000") +
labs(x= "", y="Metric tone per capita") +
scale_y_continuous(trans = "sqrt")
plot_grid(v1, v2, align = "hv", nrow = 1)
maniz <- data.frame(death_airPolution) |>
select(Country, Year, Air.pollution..total...deaths.per.100.000.) |>
group_by(Country, Air.pollution..total...deaths.per.100.000.) |>
filter(Year==1990)
my_maniz <- maniz[,-2]
colnames(my_maniz)[1] <- "region"
colnames(my_maniz)[2] <- "Airpollution_totaldeaths"
my_vec <- c("Austria", "Belgium", "Czech Republic", "Denmark", "France", "Germany", "Hungary", "Ireland", "Luxembourg", "Netherlands", "Poland", "Slovakia", "Switzerland", "Romania", "Slovenia", "Spain", "Portugal", "Italy", "Ukraine", "Norway", "Sweden", "Finland", "Greece", "Bulgaria", "Liechtenstein", "Estonia")
my_maniz <- my_maniz[is.element(my_maniz$region, my_vec),]
map_thisdata <- map_data("world") ##ggplot2
new_mapdata <- left_join(map_thisdata, my_maniz, by="region")
new_mapdata <- new_mapdata |>
filter(!is.na(new_mapdata$Airpollution_totaldeaths))
target <- ggplot(new_mapdata, aes(x = long, y = lat, group = group)) +
geom_polygon(aes(fill = Airpollution_totaldeaths), color="white") +
theme_bw() +
coord_map("bonne",  lat0 = 50)  +
ggtitle("Total Death due to Air Pollution in 100000")
target
